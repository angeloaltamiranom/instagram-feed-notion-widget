<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Instagram Feed Preview — Notion Widget</title>
  <link rel="stylesheet" href="/src/styles/main.css" />
</head>

<body>
  <div class="app">
    <div class="toolbar">
      <div class="title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="3" width="18" height="18" rx="5" stroke="white" stroke-width="1.5" />
          <circle cx="16.5" cy="7.5" r="1.5" fill="white" />
          <circle cx="12" cy="12" r="4.25" stroke="white" stroke-width="1.5" />
        </svg>
        Instagram Feed Preview
        <span class="badge">local</span>
      </div>
      <button class="btn primary" id="addBtn">Add image</button>
      <button class="btn ghost" id="updateBtn">Update from calendar</button>
      <button class="btn ghost" id="importBtn" title="Import JSON">Import</button>
      <button class="btn ghost" id="exportBtn" title="Export JSON">Export</button>
      <button class="btn danger" id="clearBtn" title="Clear all">Clear</button>
    </div>

    <div id="grid" class="grid" aria-live="polite"></div>
    <div id="emptyState" class="empty" style="display:none">
      <strong>No posts yet.</strong>
      <p>Click <em>Add image</em> or <em>Update from calendar</em> to populate your preview.</p>
    </div>

    <div class="footer">
      <span>Data is saved in your browser (localStorage).</span>
      <span>Tip: embed this page in Notion with <code>/embed</code>.</span>
    </div>
  </div>

  <!-- Add Image Modal -->
  <dialog id="addModal">
    <form method="dialog" class="modal" id="addForm">
      <h3>Add image</h3>
      <div class="field">
        <label>Image source (URL) — or upload a file below</label>
        <input type="url" id="imgUrl" placeholder="https://…/image.jpg" />
      </div>
      <div class="field">
        <div id="drop" class="dropzone">
          <input class="sr-only" type="file" id="fileInput" accept="image/*" />
          <p>Drag & drop an image here, or click to choose a file.</p>
        </div>
      </div>
      <div class="row">
        <div class="field" style="flex:2 1 260px">
          <label>Caption (optional)</label>
          <input type="text" id="caption" placeholder="Write a caption…" />
        </div>
        <div class="field" style="flex:1 1 160px">
          <label>Date (optional)</label>
          <input type="text" id="date" placeholder="2025-09-10" />
        </div>
      </div>
      <div class="actions">
        <button class="btn ghost" value="cancel">Cancel</button>
        <button class="btn primary" id="saveAdd">Add</button>
      </div>
    </form>
  </dialog>

  <!-- Update from Calendar Modal -->
  <dialog id="calModal">
    <form method="dialog" class="modal" id="calForm">
      <h3>Update from calendar</h3>
      <p style="color:#cbd5e1; margin-top:0">Two easy options:
        <br>1) Paste image URLs (one per line), or
        <br>2) Paste iCal/ICS text — we'll try to extract any image links in event descriptions.
      </p>
      <div class="field">
        <label>Paste URLs or ICS</label>
        <textarea id="calendarText" rows="8"
          placeholder="https://…/img1.jpg\nhttps://…/img2.png\n\n—or—\nBEGIN:VCALENDAR…"></textarea>
      </div>
      <div class="row">
        <button class="btn ghost small" id="appendMode" type="button" aria-pressed="true">Append mode</button>
        <span class="badge" id="countBadge">0 found</span>
      </div>
      <div class="actions">
        <button class="btn ghost" value="cancel">Cancel</button>
        <button class="btn primary" id="applyCalendar">Apply</button>
      </div>
    </form>
  </dialog>

  <!-- Import JSON Modal -->
  <dialog id="importModal">
    <form method="dialog" class="modal" id="importForm">
      <h3>Import posts (JSON)</h3>
      <div class="field">
        <textarea id="importText" rows="8" placeholder='[{"src":"https://…","caption":"…"}]'></textarea>
      </div>
      <div class="actions">
        <button class="btn ghost" value="cancel">Cancel</button>
        <button class="btn primary" id="applyImport">Import</button>
      </div>
    </form>
  </dialog>

  <script src="/src/main.js"></script>
</body>

</html>